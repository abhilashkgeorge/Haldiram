(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{u80r:function(e,t,i){"use strict";i.r(t),i.d(t,"CoreUserLazyModule",(function(){return q}));var o=i("L3Fv"),r=i("tyNb"),s=i("5aQ+"),n=i("mrSG"),c=i("9+EE"),a=i("3LXp"),l=i("bFG1"),_=i("fjkH"),d=i("4pns"),u=i("F9j1"),p=i("pHTc"),g=i("2tv+"),m=i("vbeB"),h=i("j3ag"),f=i("fXoL"),P=i("TEn/"),b=i("nt/U"),w=i("PgjG"),C=i("ofXK"),D=i("FeAf"),E=i("ACYt"),v=i("3CSS"),U=i("iSJP"),I=i("f1LK"),y=i("hMzs"),A=i("r8G5"),T=i("sYmb");function CoreUserAboutPage_ion_list_14_ion_button_3_Template(e,t){if(1&e){const e=f.Fc();f.Ec(0,"ion-button",13),f.Mc("click",(function CoreUserAboutPage_ion_list_14_ion_button_3_Template_ion_button_click_0_listener(){f.fd(e);return f.Oc(2).changeProfilePicture()})),f.Pc(1,"translate"),f.zc(2,"ion-icon",14),f.Dc()}2&e&&f.mc("aria-label",f.Qc(1,1,"core.user.newpicture"))}function CoreUserAboutPage_ion_list_14_p_7_Template(e,t){if(1&e&&(f.Ec(0,"p"),f.zc(1,"ion-icon",15),f.pd(2),f.Dc()),2&e){const e=f.Oc(2);f.lc(1),f.mc("aria-hidden",!0),f.lc(1),f.rd(" ",e.user.address," ")}}function CoreUserAboutPage_ion_list_14_ion_item_group_8_ion_item_6_Template(e,t){if(1&e&&(f.Ec(0,"ion-item",18),f.Ec(1,"ion-label"),f.Ec(2,"p",16),f.pd(3),f.Pc(4,"translate"),f.Dc(),f.Ec(5,"p"),f.Ec(6,"a",19),f.pd(7),f.Dc(),f.Dc(),f.Dc(),f.Dc()),2&e){const e=f.Oc(3);f.lc(3),f.qd(f.Qc(4,4,"core.user.email")),f.lc(3),f.Xc("href","mailto:",e.user.email,"",f.id),f.Vc("showBrowserWarning",!1),f.lc(1),f.rd(" ",e.user.email," ")}}function CoreUserAboutPage_ion_list_14_ion_item_group_8_ion_item_7_Template(e,t){if(1&e&&(f.Ec(0,"ion-item",18),f.Ec(1,"ion-label"),f.Ec(2,"p",16),f.pd(3),f.Pc(4,"translate"),f.Dc(),f.Ec(5,"p"),f.Ec(6,"a",19),f.pd(7),f.Dc(),f.Dc(),f.Dc(),f.Dc()),2&e){const e=f.Oc(3);f.lc(3),f.qd(f.Qc(4,4,"core.user.phone1")),f.lc(3),f.Xc("href","tel:",e.user.phone1,"",f.id),f.Vc("showBrowserWarning",!1),f.lc(1),f.rd(" ",e.user.phone1," ")}}function CoreUserAboutPage_ion_list_14_ion_item_group_8_ion_item_8_Template(e,t){if(1&e&&(f.Ec(0,"ion-item",18),f.Ec(1,"ion-label"),f.Ec(2,"p",16),f.pd(3),f.Pc(4,"translate"),f.Dc(),f.Ec(5,"p"),f.Ec(6,"a",19),f.pd(7),f.Dc(),f.Dc(),f.Dc(),f.Dc()),2&e){const e=f.Oc(3);f.lc(3),f.qd(f.Qc(4,4,"core.user.phone2")),f.lc(3),f.Xc("href","tel:",e.user.phone2,"",f.id),f.Vc("showBrowserWarning",!1),f.lc(1),f.rd(" ",e.user.phone2," ")}}function CoreUserAboutPage_ion_list_14_ion_item_group_8_ion_item_9_Template(e,t){if(1&e&&(f.Ec(0,"ion-item",18),f.Ec(1,"ion-label"),f.Ec(2,"p",16),f.pd(3),f.Pc(4,"translate"),f.Dc(),f.Ec(5,"p"),f.pd(6),f.Dc(),f.Dc(),f.Dc()),2&e){const e=f.Oc(3);f.lc(3),f.qd(f.Qc(4,2,"core.user.city")),f.lc(3),f.qd(e.user.city)}}function CoreUserAboutPage_ion_list_14_ion_item_group_8_ion_item_10_Template(e,t){if(1&e&&(f.Ec(0,"ion-item",18),f.Ec(1,"ion-label"),f.Ec(2,"p",16),f.pd(3),f.Pc(4,"translate"),f.Dc(),f.Ec(5,"p"),f.pd(6),f.Dc(),f.Dc(),f.Dc()),2&e){const e=f.Oc(3);f.lc(3),f.qd(f.Qc(4,2,"core.user.country")),f.lc(3),f.qd(e.user.country)}}function CoreUserAboutPage_ion_list_14_ion_item_group_8_ion_item_11_Template(e,t){if(1&e&&(f.Ec(0,"ion-item",18),f.Ec(1,"ion-label"),f.Ec(2,"p",16),f.pd(3),f.Pc(4,"translate"),f.Dc(),f.Ec(5,"p"),f.pd(6),f.Dc(),f.Dc(),f.Dc()),2&e){const e=f.Oc(3);f.lc(3),f.qd(f.Qc(4,2,"core.timezone")),f.lc(3),f.qd(e.user.timezone)}}function CoreUserAboutPage_ion_list_14_ion_item_group_8_ng_container_12_ion_item_1_Template(e,t){if(1&e&&(f.Ec(0,"ion-item",18),f.Ec(1,"ion-label"),f.Ec(2,"p",16),f.pd(3),f.Pc(4,"translate"),f.Dc(),f.Ec(5,"p"),f.pd(6),f.Dc(),f.Dc(),f.Dc()),2&e){const e=f.Oc(4);f.lc(3),f.qd(f.Qc(4,2,"core.user.idnumber")),f.lc(3),f.qd(e.user.idnumber)}}function CoreUserAboutPage_ion_list_14_ion_item_group_8_ng_container_12_ion_item_2_Template(e,t){if(1&e&&(f.Ec(0,"ion-item",18),f.Ec(1,"ion-label"),f.Ec(2,"p",16),f.pd(3),f.Pc(4,"translate"),f.Dc(),f.Ec(5,"p"),f.pd(6),f.Dc(),f.Dc(),f.Dc()),2&e){const e=f.Oc(4);f.lc(3),f.qd(f.Qc(4,2,"core.user.institution")),f.lc(3),f.qd(e.user.institution)}}function CoreUserAboutPage_ion_list_14_ion_item_group_8_ng_container_12_ion_item_3_Template(e,t){if(1&e&&(f.Ec(0,"ion-item",18),f.Ec(1,"ion-label"),f.Ec(2,"p",16),f.pd(3),f.Pc(4,"translate"),f.Dc(),f.Ec(5,"p"),f.pd(6),f.Dc(),f.Dc(),f.Dc()),2&e){const e=f.Oc(4);f.lc(3),f.qd(f.Qc(4,2,"core.user.department")),f.lc(3),f.qd(e.user.department)}}function CoreUserAboutPage_ion_list_14_ion_item_group_8_ng_container_12_Template(e,t){if(1&e&&(f.Cc(0),f.nd(1,CoreUserAboutPage_ion_list_14_ion_item_group_8_ng_container_12_ion_item_1_Template,7,4,"ion-item",17),f.nd(2,CoreUserAboutPage_ion_list_14_ion_item_group_8_ng_container_12_ion_item_2_Template,7,4,"ion-item",17),f.nd(3,CoreUserAboutPage_ion_list_14_ion_item_group_8_ng_container_12_ion_item_3_Template,7,4,"ion-item",17),f.Bc()),2&e){const e=f.Oc(3);f.lc(1),f.Vc("ngIf",e.user.idnumber),f.lc(1),f.Vc("ngIf",e.user.institution),f.lc(1),f.Vc("ngIf",e.user.department)}}function CoreUserAboutPage_ion_list_14_ion_item_group_8_Template(e,t){if(1&e&&(f.Ec(0,"ion-item-group"),f.Ec(1,"ion-item-divider"),f.Ec(2,"ion-label"),f.Ec(3,"p",16),f.pd(4),f.Pc(5,"translate"),f.Dc(),f.Dc(),f.Dc(),f.nd(6,CoreUserAboutPage_ion_list_14_ion_item_group_8_ion_item_6_Template,8,6,"ion-item",17),f.nd(7,CoreUserAboutPage_ion_list_14_ion_item_group_8_ion_item_7_Template,8,6,"ion-item",17),f.nd(8,CoreUserAboutPage_ion_list_14_ion_item_group_8_ion_item_8_Template,8,6,"ion-item",17),f.nd(9,CoreUserAboutPage_ion_list_14_ion_item_group_8_ion_item_9_Template,7,4,"ion-item",17),f.nd(10,CoreUserAboutPage_ion_list_14_ion_item_group_8_ion_item_10_Template,7,4,"ion-item",17),f.nd(11,CoreUserAboutPage_ion_list_14_ion_item_group_8_ion_item_11_Template,7,4,"ion-item",17),f.nd(12,CoreUserAboutPage_ion_list_14_ion_item_group_8_ng_container_12_Template,4,3,"ng-container",6),f.Dc()),2&e){const e=f.Oc(2);f.lc(4),f.qd(f.Qc(5,8,"core.user.contact")),f.lc(2),f.Vc("ngIf",e.user.email),f.lc(1),f.Vc("ngIf",e.user.phone1),f.lc(1),f.Vc("ngIf",e.user.phone2),f.lc(1),f.Vc("ngIf",e.user.city),f.lc(1),f.Vc("ngIf",e.user.country),f.lc(1),f.Vc("ngIf",e.displayTimezone&&e.user.timezone),f.lc(1),f.Vc("ngIf",e.canShowDepartment)}}function CoreUserAboutPage_ion_list_14_ion_item_group_9_ion_item_6_Template(e,t){if(1&e&&(f.Ec(0,"ion-item",18),f.Ec(1,"ion-label"),f.Ec(2,"p",16),f.pd(3),f.Pc(4,"translate"),f.Dc(),f.Ec(5,"p"),f.Ec(6,"a",22),f.pd(7),f.Dc(),f.Dc(),f.Dc(),f.Dc()),2&e){const e=f.Oc(3);f.lc(3),f.qd(f.Qc(4,3,"core.user.webpage")),f.lc(3),f.Wc("href",e.user.url,f.id),f.lc(1),f.rd(" ",e.user.url," ")}}function CoreUserAboutPage_ion_list_14_ion_item_group_9_ion_item_7_ion_badge_5_Template(e,t){if(1&e){const e=f.Fc();f.Ec(0,"ion-badge",25),f.Mc("click",(function CoreUserAboutPage_ion_list_14_ion_item_group_9_ion_item_7_ion_badge_5_Template_ion_badge_click_0_listener(){f.fd(e);const i=t.$implicit;return f.Oc(4).openInterest(i)})),f.pd(1),f.Dc()}if(2&e){const e=t.$implicit;f.lc(1),f.rd(" ",e," ")}}function CoreUserAboutPage_ion_list_14_ion_item_group_9_ion_item_7_Template(e,t){if(1&e&&(f.Ec(0,"ion-item",23),f.Ec(1,"ion-label"),f.Ec(2,"p",16),f.pd(3),f.Pc(4,"translate"),f.Dc(),f.nd(5,CoreUserAboutPage_ion_list_14_ion_item_group_9_ion_item_7_ion_badge_5_Template,2,1,"ion-badge",24),f.Dc(),f.Dc()),2&e){const e=f.Oc(3);f.lc(3),f.qd(f.Qc(4,2,"core.user.interests")),f.lc(2),f.Vc("ngForOf",e.interests)}}function CoreUserAboutPage_ion_list_14_ion_item_group_9_core_user_profile_field_8_Template(e,t){if(1&e&&f.zc(0,"core-user-profile-field",26),2&e){const e=t.$implicit,i=f.Oc(3);f.Vc("field",e)("contextInstanceId",i.courseId)("courseId",i.courseId)}}function CoreUserAboutPage_ion_list_14_ion_item_group_9_Template(e,t){if(1&e&&(f.Ec(0,"ion-item-group"),f.Ec(1,"ion-item-divider"),f.Ec(2,"ion-label"),f.Ec(3,"p",16),f.pd(4),f.Pc(5,"translate"),f.Dc(),f.Dc(),f.Dc(),f.nd(6,CoreUserAboutPage_ion_list_14_ion_item_group_9_ion_item_6_Template,8,5,"ion-item",17),f.nd(7,CoreUserAboutPage_ion_list_14_ion_item_group_9_ion_item_7_Template,6,4,"ion-item",20),f.nd(8,CoreUserAboutPage_ion_list_14_ion_item_group_9_core_user_profile_field_8_Template,1,3,"core-user-profile-field",21),f.Dc()),2&e){const e=f.Oc(2);f.lc(4),f.qd(f.Qc(5,4,"core.userdetails")),f.lc(2),f.Vc("ngIf",e.user.url),f.lc(1),f.Vc("ngIf",e.interests),f.lc(1),f.Vc("ngForOf",e.user.customfields)}}function CoreUserAboutPage_ion_list_14_ion_item_group_14_Template(e,t){if(1&e&&(f.Ec(0,"ion-item-group"),f.Ec(1,"ion-item-divider"),f.Ec(2,"ion-label"),f.Ec(3,"p",16),f.pd(4),f.Pc(5,"translate"),f.Dc(),f.Dc(),f.Dc(),f.Ec(6,"ion-item",18),f.Ec(7,"ion-label"),f.Ec(8,"p"),f.zc(9,"core-format-text",27),f.Dc(),f.Dc(),f.Dc(),f.Dc()),2&e){const e=f.Oc(2);f.lc(4),f.qd(f.Qc(5,3,"core.user.description")),f.lc(5),f.Vc("text",e.user.description)("contextInstanceId",e.user.id)}}function CoreUserAboutPage_ion_list_14_Template(e,t){if(1&e){const e=f.Fc();f.Ec(0,"ion-list"),f.Ec(1,"ion-item",8),f.Ec(2,"core-user-avatar",9),f.nd(3,CoreUserAboutPage_ion_list_14_ion_button_3_Template,3,3,"ion-button",10),f.Dc(),f.Ec(4,"ion-label"),f.Ec(5,"h2"),f.pd(6),f.Dc(),f.nd(7,CoreUserAboutPage_ion_list_14_p_7_Template,3,2,"p",6),f.Dc(),f.Dc(),f.nd(8,CoreUserAboutPage_ion_list_14_ion_item_group_8_Template,13,10,"ion-item-group",6),f.nd(9,CoreUserAboutPage_ion_list_14_ion_item_group_9_Template,9,6,"ion-item-group",6),f.Ec(10,"div",11),f.Ec(11,"ion-button",12),f.Mc("click",(function CoreUserAboutPage_ion_list_14_Template_ion_button_click_11_listener(){f.fd(e);return f.Oc().changePassword()})),f.pd(12),f.Pc(13,"translate"),f.Dc(),f.Dc(),f.nd(14,CoreUserAboutPage_ion_list_14_ion_item_group_14_Template,10,5,"ion-item-group",6),f.Dc()}if(2&e){const e=f.Oc();f.lc(2),f.Vc("user",e.user)("userId",e.user.id)("linkProfile",!1)("checkOnline",!e.canChangeProfilePicture),f.lc(1),f.Vc("ngIf",e.canChangeProfilePicture),f.lc(3),f.qd(e.user.fullname),f.lc(1),f.Vc("ngIf",e.user.address),f.lc(1),f.Vc("ngIf",e.hasContact),f.lc(1),f.Vc("ngIf",e.hasDetails),f.lc(3),f.rd(" ",f.Qc(13,11,"Change Password")," "),f.lc(2),f.Vc("ngIf",e.user.description)}}function CoreUserAboutPage_core_empty_box_15_Template(e,t){1&e&&(f.zc(0,"core-empty-box",28),f.Pc(1,"translate")),2&e&&f.Vc("message",f.Qc(1,1,"core.user.detailsnotavailable"))}let O=(()=>{class CoreUserAboutPage{constructor(){this.userLoaded=!1,this.hasContact=!1,this.hasDetails=!1,this.canChangeProfilePicture=!1,this.displayTimezone=!1,this.canShowDepartment=!1;try{this.site=c.b.getRequiredCurrentSite()}catch(e){return a.a.showErrorModal(e),p.a.back(),void 0}this.obsProfileRefreshed=_.b.on(d.e,(e=>{this.user&&e.user&&(this.user.email=e.user.email,this.user.address=u.a.formatAddress("",e.user.city,e.user.country))}),c.b.getCurrentSiteId())}ngOnInit(){return Object(n.a)(this,void 0,void 0,(function*(){this.userId=p.a.getRouteNumberParam("userId")||0,this.courseId=p.a.getRouteNumberParam("courseId")||0,this.canShowDepartment=this.userId!=this.site.getUserId(),this.siteName=p.a.getRouteParam("siteName"),this.canChangeProfilePicture=!this.courseId&&this.userId==this.site.getUserId()&&this.site.canUploadFiles()&&!d.a.isUpdatePictureDisabledInSite(this.site),this.fetchUser().finally((()=>{this.userLoaded=!0}))}))}fetchUser(){var e;return Object(n.a)(this,void 0,void 0,(function*(){try{const t=yield d.a.getProfile(this.userId,this.courseId);this.interests=t.interests?t.interests.split(",").map((e=>e.trim())):void 0,this.hasContact=!!(t.email||t.phone1||t.phone2||t.city||t.country||t.address),this.hasDetails=!!(t.url||t.interests||t.customfields&&t.customfields.length>0),this.user=t,this.title=t.fullname,this.user.address=u.a.formatAddress("",t.city,t.country);const i=null===(e=c.b.getCurrentSite())||void 0===e?void 0:e.getStoredConfig("timezone");this.displayTimezone=!!i,this.displayTimezone&&this.user.timezone===d.f&&(this.user.timezone=i),yield this.checkUserImageUpdated()}catch(e){a.a.showErrorModalDefault(e,"core.user.errorloaduser",!0)}}))}changePassword(){p.a.navigateToSitePath("user/changeuserpassword")}checkUserImageUpdated(){return Object(n.a)(this,void 0,void 0,(function*(){if(this.site&&this.site.getInfo()&&this.user&&this.userId==this.site.getUserId()&&this.isUserAvatarDirty()){try{yield c.b.updateSiteInfo(this.site.getId())}catch(e){_.b.trigger(d.d,{userId:this.userId,picture:this.user.profileimageurl},this.site.getId())}this.isUserAvatarDirty()?yield this.refreshUser():_.b.trigger(d.d,{userId:this.userId,picture:this.user.profileimageurl},this.site.getId())}}))}changeProfilePicture(){return Object(n.a)(this,void 0,void 0,(function*(){const e=h.J.instant("core.user.newpicture"),t=m.a.getGroupMimeInfo("image","mimetypes");let i;try{const o=yield g.a.selectAndUploadFile(-1,e,t);i=yield a.a.showModalLoading("core.sending",!0);const r=yield d.a.changeProfilePicture(o.itemid,this.userId,this.site.getId());_.b.trigger(d.d,{userId:this.userId,picture:r},this.site.getId()),c.b.updateSiteInfo(this.site.getId()),this.refreshUser()}catch(e){a.a.showErrorModal(e)}finally{null==i?void 0:i.dismiss()}}))}refreshUser(e){return Object(n.a)(this,void 0,void 0,(function*(){yield l.a.ignoreErrors(d.a.invalidateUserCache(this.userId)),yield this.fetchUser(),null==e||e.complete(),this.user&&_.b.trigger(d.e,{courseId:this.courseId,userId:this.userId,user:this.user},this.site.getId())}))}isUserAvatarDirty(){var e;if(!this.user||!this.site)return!1;return this.normalizeAvatarUrl(this.user.profileimageurl)!==this.normalizeAvatarUrl(null===(e=this.site.getInfo())||void 0===e?void 0:e.userpictureurl)}normalizeAvatarUrl(e){var t;return e?e.startsWith(`${null===(t=this.site)||void 0===t?void 0:t.siteUrl}/theme/image.php`)?"default":e:"undefined"}openInterest(e){p.a.navigateToSitePath("/tag/index",{params:{tagName:e}})}ngOnDestroy(){var e;null===(e=this.obsProfileRefreshed)||void 0===e?void 0:e.off()}}return CoreUserAboutPage.ɵfac=function CoreUserAboutPage_Factory(e){return new(e||CoreUserAboutPage)},CoreUserAboutPage.ɵcmp=f.sc({type:CoreUserAboutPage,selectors:[["page-core-user-about"]],decls:16,vars:13,consts:[["slot","start"],[3,"text"],[1,"limited-width"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[4,"ngIf"],["icon","fas-user",3,"message",4,"ngIf"],["lines","full",1,"ion-text-center","core-user-profile-maininfo","ion-text-wrap"],[3,"user","userId","linkProfile","checkOnline"],["class","edit-avatar","fill","clear",3,"click",4,"ngIf"],[1,"ion-text-center"],["size","small",3,"click"],["fill","clear",1,"edit-avatar",3,"click"],["slot","icon-only","name","fas-pen","aria-hidden","true"],["name","fas-location-dot"],[1,"item-heading"],["class","ion-text-wrap",4,"ngIf"],[1,"ion-text-wrap"],["core-link","","auto-login","no",1,"core-anchor",3,"href","showBrowserWarning"],["class","ion-text-wrap core-user-profile-interests",4,"ngIf"],["contextLevel","course",3,"field","contextInstanceId","courseId",4,"ngFor","ngForOf"],["core-link","",1,"core-anchor",3,"href"],[1,"ion-text-wrap","core-user-profile-interests"],["role","link",3,"click",4,"ngFor","ngForOf"],["role","link",3,"click"],["contextLevel","course",3,"field","contextInstanceId","courseId"],["contextLevel","user",3,"text","contextInstanceId"],["icon","fas-user",3,"message"]],template:function CoreUserAboutPage_Template(e,t){1&e&&(f.Ec(0,"ion-header"),f.Ec(1,"ion-toolbar"),f.Ec(2,"ion-buttons",0),f.zc(3,"ion-back-button",1),f.Pc(4,"translate"),f.Dc(),f.Ec(5,"ion-title"),f.Ec(6,"h1"),f.pd(7),f.Pc(8,"translate"),f.Dc(),f.Dc(),f.Dc(),f.Dc(),f.Ec(9,"ion-content",2),f.Ec(10,"ion-refresher",3),f.Mc("ionRefresh",(function CoreUserAboutPage_Template_ion_refresher_ionRefresh_10_listener(e){return t.refreshUser(e.target)})),f.zc(11,"ion-refresher-content",4),f.Pc(12,"translate"),f.Dc(),f.Ec(13,"core-loading",5),f.nd(14,CoreUserAboutPage_ion_list_14_Template,15,13,"ion-list",6),f.nd(15,CoreUserAboutPage_core_empty_box_15_Template,2,3,"core-empty-box",7),f.Dc(),f.Dc()),2&e&&(f.lc(3),f.Vc("text",f.Qc(4,7,"core.back")),f.lc(4),f.qd(f.Qc(8,9,"core.user.profile")),f.lc(3),f.Vc("disabled",!t.userLoaded),f.lc(1),f.Wc("pullingText",f.Qc(12,11,"core.pulltorefresh")),f.lc(2),f.Vc("hideUntil",t.userLoaded),f.lc(1),f.Vc("ngIf",t.user),f.lc(1),f.Vc("ngIf",!t.user||!t.hasContact&&!t.hasDetails&&!t.user.description))},directives:[P.C,P.Ab,P.m,P.h,P.i,P.yb,b.a,P.v,P.bb,P.cb,w.a,C.t,P.P,P.I,D.a,P.O,E.a,P.l,P.D,v.a,P.K,P.J,U.a,C.s,P.k,I.a,y.a,A.a],pipes:[T.d],styles:["[_nghost-%COMP%]   .core-user-profile-maininfo[_ngcontent-%COMP%]::part(native){flex-direction:column}[_nghost-%COMP%]     core-user-avatar{display:block;--core-avatar-size:var(--core-large-avatar-size);height:calc(var(--core-avatar-size) + 16px)}[_nghost-%COMP%]     core-user-avatar img{margin:8px auto}[_nghost-%COMP%]     core-user-avatar .contact-status{width:24px!important;height:24px!important;right:calc(50% - 12px - var(--core-avatar-size) / 2)!important}[_nghost-%COMP%]     core-user-avatar .edit-avatar{position:absolute;right:calc(50% - 15px - var(--core-avatar-size) / 2);bottom:-12px}[dir=rtl][_nghost-%COMP%]   [_nghost-%COMP%]     core-user-avatar .edit-avatar, [dir=rtl]   [_nghost-%COMP%]   [_nghost-%COMP%]     core-user-avatar .edit-avatar{left:0;right:unset}[_nghost-%COMP%]     core-user-avatar .edit-avatar::part(native){border-radius:50%;background:var(--ion-item-background)}[_nghost-%COMP%]   .core-user-profile-interests[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{cursor:pointer;margin-left:4px;margin-right:4px}[dir=rtl][_nghost-%COMP%]     core-user-avatar .edit-avatar, [dir=rtl]   [_nghost-%COMP%]     core-user-avatar .edit-avatar{left:-24px;right:unset}"]}),CoreUserAboutPage})();var M=i("mv9v"),x=i("51eS"),k=i("3Pt+");let z=(()=>{class ChangePasswordPage{constructor(){var e,t;this.changingPassword=!1,this.newPassword="",this.confirmPassword="",this.username="",this.password="",this.logoutLabel=M.a.getLogoutLabel();const i=c.b.getCurrentSite();try{this.site=c.b.getRequiredCurrentSite(),this.userId=c.b.getCurrentSiteUserId(),this.username=i&&null!==(t=null===(e=i.getInfo())||void 0===e?void 0:e.username)&&void 0!==t?t:""}catch(e){return a.a.showErrorModal(e),p.a.back(),void 0}}isPasswordValid(e){return e.length>=7}hasLowerCase(e){return/[a-z]/.test(e)}hasUpperCase(e){return/[A-Z]/.test(e)}hasSpecialCharacter(e){return/[!@#$%^&*()_+{}\[\]:;<>,.?~\-\/\\]/.test(e)}hasDigit(e){return/[0-9]/.test(e)}isFormValid(){return""!==this.newPassword.trim()&&""!==this.confirmPassword.trim()}isPasswordStrong(e){const t=/[A-Z]/.test(e),i=/[a-z]/.test(e),o=/[0-9]/.test(e),r=/[!@#$%^&*()_+{}\[\]:;<>,.?~\-\/\\]/.test(e);return!(!(t&&i&&o&&r)||e.length<7)||(x.a.showAlert(h.J.instant("Password Requirements Not Satisified"),"Try Again"),!1)}login(){return Object(n.a)(this,void 0,void 0,(function*(){if(!this.isFormValid())return x.a.showAlert(h.J.instant("Password Cannot be Empty"),"Error"),void 0;if(!this.isPasswordStrong(this.newPassword))return;if(this.newPassword!==this.confirmPassword)return x.a.showAlert(h.J.instant("Passwords do not match."),"Try Again"),this.newPassword="",this.confirmPassword="",void 0;const e=yield a.a.showModalLoading();try{const e=`https://lms.haldiram.com/webservice/rest/server.php?moodlewsrestformat=json&wstoken=${(yield c.b.getUserToken("https://lms.haldiram.com/",this.username,this.password)).token}&wsfunction=local_webservice_change_password&userid=${this.userId}&newpassword=${this.newPassword}&confirmpassword=${this.confirmPassword}`,t=yield this.changePasswordDirectly(e);console.log("This is the Response:",t),x.a.showAlert("Password Changed","Success"),this.password="",this.newPassword="",this.confirmPassword="",p.a.navigateToSiteHome()}catch(e){x.a.showAlert("Invalid Credentials","Try Again")}finally{e.dismiss()}}))}changePasswordDirectly(e){return Object(n.a)(this,void 0,void 0,(function*(){try{const t=yield fetch(e,{method:"POST"});console.log("This is response inside the function",t);const i=yield t.json();return{success:i.success,message:i.message}}catch(e){return{success:"false",message:"An error occurred"+e.message}}}))}ngOnDestroy(){var e,t,i;null===(e=this.urlLoadedObserver)||void 0===e?void 0:e.off(),null===(t=this.messageObserver)||void 0===t||t.off(),null===(i=this.browserClosedObserver)||void 0===i||i.off()}}return ChangePasswordPage.ɵfac=function ChangePasswordPage_Factory(e){return new(e||ChangePasswordPage)},ChangePasswordPage.ɵcmp=f.sc({type:ChangePasswordPage,selectors:[["page-core-login-change-password"]],decls:66,vars:50,consts:[["slot","start"],[3,"text"],[1,"list-item-limited-width"],[1,"ion-text-wrap","ion-margin-bottom"],["lines","none"],[2,"margin-right","10px",3,"name","color"],[1,"ion-text-wrap"],["position","stacked",1,"input-label","user-text"],["position","stacked",1,"input-label"],["type","password",1,"input-field",3,"ngModel","ngModelChange"],["expand","block",1,"ion-text-wrap","ion-margin-top",3,"click"]],template:function ChangePasswordPage_Template(e,t){1&e&&(f.Ec(0,"ion-header"),f.Ec(1,"ion-toolbar"),f.Ec(2,"ion-buttons",0),f.zc(3,"ion-back-button",1),f.Pc(4,"translate"),f.Dc(),f.Ec(5,"ion-title"),f.Ec(6,"h1"),f.pd(7),f.Pc(8,"translate"),f.Dc(),f.Dc(),f.Dc(),f.Dc(),f.Ec(9,"ion-content"),f.Ec(10,"ion-list",2),f.Cc(11),f.Ec(12,"ion-item",3),f.Ec(13,"ion-label"),f.Ec(14,"h2"),f.pd(15),f.Pc(16,"translate"),f.Dc(),f.Ec(17,"ion-card"),f.Ec(18,"ion-card-content"),f.Ec(19,"ion-list",4),f.Ec(20,"ion-item"),f.zc(21,"ion-icon",5),f.Ec(22,"ion-label",6),f.pd(23),f.Pc(24,"translate"),f.Dc(),f.Dc(),f.Ec(25,"ion-item"),f.zc(26,"ion-icon",5),f.Ec(27,"ion-label",6),f.pd(28),f.Pc(29,"translate"),f.Dc(),f.Dc(),f.Ec(30,"ion-item"),f.zc(31,"ion-icon",5),f.Ec(32,"ion-label",6),f.pd(33),f.Pc(34,"translate"),f.Dc(),f.Dc(),f.Ec(35,"ion-item"),f.zc(36,"ion-icon",5),f.Ec(37,"ion-label",6),f.pd(38),f.Pc(39,"translate"),f.Dc(),f.Dc(),f.Ec(40,"ion-item"),f.zc(41,"ion-icon",5),f.Ec(42,"ion-label",6),f.pd(43),f.Pc(44,"translate"),f.Dc(),f.Dc(),f.Dc(),f.Dc(),f.Dc(),f.Dc(),f.Dc(),f.Ec(45,"ion-item",6),f.Ec(46,"ion-label",7),f.pd(47),f.Dc(),f.Dc(),f.Ec(48,"ion-item",6),f.Ec(49,"ion-label",8),f.pd(50),f.Pc(51,"translate"),f.Dc(),f.Ec(52,"ion-input",9),f.Mc("ngModelChange",(function ChangePasswordPage_Template_ion_input_ngModelChange_52_listener(e){return t.password=e})),f.Dc(),f.Dc(),f.Ec(53,"ion-item",6),f.Ec(54,"ion-label",8),f.pd(55),f.Pc(56,"translate"),f.Dc(),f.Ec(57,"ion-input",9),f.Mc("ngModelChange",(function ChangePasswordPage_Template_ion_input_ngModelChange_57_listener(e){return t.newPassword=e})),f.Dc(),f.Dc(),f.Ec(58,"ion-item",6),f.Ec(59,"ion-label",8),f.pd(60),f.Pc(61,"translate"),f.Dc(),f.Ec(62,"ion-input",9),f.Mc("ngModelChange",(function ChangePasswordPage_Template_ion_input_ngModelChange_62_listener(e){return t.confirmPassword=e})),f.Dc(),f.Dc(),f.Ec(63,"ion-button",10),f.Mc("click",(function ChangePasswordPage_Template_ion_button_click_63_listener(){return t.login()})),f.pd(64),f.Pc(65,"translate"),f.Dc(),f.Bc(),f.Dc(),f.Dc()),2&e&&(f.lc(3),f.Vc("text",f.Qc(4,26,"core.back")),f.lc(4),f.qd(f.Qc(8,28,"core.login.changepassword")),f.lc(8),f.qd(f.Qc(16,30,"You must change your password to proceed")),f.lc(6),f.Vc("name",t.isPasswordValid(t.newPassword)?"checkmark-circle":"close-circle")("color",t.isPasswordValid(t.newPassword)?"success":"danger"),f.lc(2),f.qd(f.Qc(24,32,"Password must be at least 7 characters long.")),f.lc(3),f.Vc("name",t.hasLowerCase(t.newPassword)?"checkmark-circle":"close-circle")("color",t.hasLowerCase(t.newPassword)?"success":"danger"),f.lc(2),f.qd(f.Qc(29,34,"Password must have at least 1 lower case letter(s).")),f.lc(3),f.Vc("name",t.hasUpperCase(t.newPassword)?"checkmark-circle":"close-circle")("color",t.hasUpperCase(t.newPassword)?"success":"danger"),f.lc(2),f.qd(f.Qc(34,36,"Password must have at least 1 upper case letter(s).")),f.lc(3),f.Vc("name",t.hasSpecialCharacter(t.newPassword)?"checkmark-circle":"close-circle")("color",t.hasSpecialCharacter(t.newPassword)?"success":"danger"),f.lc(2),f.qd(f.Qc(39,38,"Password must have at least 1 special character(s) such as *, -, or #")),f.lc(3),f.Vc("name",t.hasSpecialCharacter(t.newPassword)?"checkmark-circle":"close-circle")("color",t.hasDigit(t.newPassword)?"success":"danger"),f.lc(2),f.qd(f.Qc(44,40,"Password must have at least 1 digit(s).")),f.lc(4),f.rd(" Enter the password for ",t.username,""),f.lc(3),f.qd(f.Qc(51,42,"Current Password")),f.lc(2),f.Vc("ngModel",t.password),f.lc(3),f.qd(f.Qc(56,44,"core.login.newpassword")),f.lc(2),f.Vc("ngModel",t.newPassword),f.lc(3),f.qd(f.Qc(61,46,"core.login.confirmpassword")),f.lc(2),f.Vc("ngModel",t.confirmPassword),f.lc(2),f.rd(" ",f.Qc(65,48,"core.login.changepassword")," "))},directives:[P.C,P.Ab,P.m,P.h,P.i,P.yb,b.a,P.v,P.P,P.I,P.O,P.n,P.o,P.D,v.a,P.H,P.Pb,k.r,k.u,E.a,P.l],pipes:[T.d],styles:[".input-label[_ngcontent-%COMP%]{font-size:17px;font-family:Arial,Helvetica,sans-serif;font-weight:400}.input-label[_ngcontent-%COMP%], .user-text[_ngcontent-%COMP%]{color:#000;margin-bottom:10px}.user-text[_ngcontent-%COMP%]{font-size:20px;font-weight:700}.input-field[_ngcontent-%COMP%]{font-size:16px}.input-box[_ngcontent-%COMP%]{display:block;border:1px solid #ccc;padding:8px;border-radius:4px;margin-top:8px}.item-highlight[_ngcontent-%COMP%]{display:none}"]}),ChangePasswordPage})();const V=[{path:"",redirectTo:"profile",pathMatch:"full"},{path:"profile",loadChildren:()=>Promise.all([i.e(11),i.e(0)]).then(i.bind(null,"XusI")).then((e=>e.CoreUserProfileLazyModule))},{path:"about",component:O},{path:"changeuserpassword",component:z}];let q=(()=>{class CoreUserLazyModule{}return CoreUserLazyModule.ɵmod=f.wc({type:CoreUserLazyModule}),CoreUserLazyModule.ɵinj=f.vc({factory:function CoreUserLazyModule_Factory(e){return new(e||CoreUserLazyModule)},imports:[[r.m.forChild(V),o.a,s.a]]}),CoreUserLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&f.kd(q,{declarations:[O,z],imports:[r.m,o.a,s.a]}))}}]);